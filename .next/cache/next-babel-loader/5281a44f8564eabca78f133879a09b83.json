{"ast":null,"code":"var _jsxFileName = \"/home/balaji/hello-next/components/Maps.js\";\nvar __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport { Map, TileLayer, Popup, LayersControl, GeoJSON } from \"react-leaflet-universal\";\nimport \"leaflet/dist/leaflet.css\";\nimport diss from '../data/Dissemination.json';\nimport '@shopify/polaris/styles.css';\nimport { Card, Layout, Spinner } from '@shopify/polaris';\nimport axios from 'axios';\nimport dynamic from 'next/dynamic';\nconst Barplot = dynamic(() => import('./BarPlot'), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('./BarPlot')],\n    modules: ['./BarPlot']\n  }\n}); // L.Icon.Default.imagePath = '.';\n// // OR\n// delete L.Icon.Default.prototype._getIconUrl;\n// L.Icon.Default.mergeOptions({\n//   iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n//   iconUrl: require('leaflet/dist/images/marker-icon.png'),\n//   shadowUrl: require('leaflet/dist/images/marker-shadow.png'),\n// });\n\nlet numMapClicks = 0;\nlet geoMapClicks = 0;\nlet geoMapClicks2 = 0;\n\nclass Maps extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"getColor\", val => {\n      return val >= -1 && val < -0.75 ? '#a50026' : val >= -0.75 && val < -0.6 ? '#d73027' : val >= -0.6 && val < -0.4 ? '#f46d43' : val >= -0.4 && val < -0.2 ? '#fdae61' : val >= -0.2 && val < 0 ? '#fee08b' : val >= 0.01 && val < 0.1 ? '#d9ef8b' : val >= 0.1 && val < 0.3 ? '#a6d96a' : val >= 0.3 && val < 0.5 ? '#66bd63' : val >= 0.5 && val < 0.75 ? '#1a9850' : val >= 0.75 && val <= 1 ? '#006837' : val >= 0 && val < 0.01 ? '#ffffff' : '#000000';\n    });\n\n    _defineProperty(this, \"onEachFeature2\", (feature, layer) => {\n      //layer.setStyle({fillColor : this.state.color2 ,color:this.state.color2,opacity:this.state.opacity,fillOpacity:0.4,weight:0.4})\n      if (this.state.intdata.length === 0) {\n        this.setState({\n          iLoading: false\n        });\n      } else {\n        this.setState({\n          iLoading: true\n        });\n      }\n\n      layer.on('click', e => {\n        if (this.state.iLoading) {\n          var data = {};\n          data['DAUID'] = feature.properties.DAUID;\n          this.setState({\n            cmpload: true\n          });\n          axios.get('http://localhost:5000/rest/explainer/', {\n            params: data\n          }).then(result => {\n            var rX = [];\n            var rY = [];\n            var rdata = result.data['exp'];\n\n            for (var i = 0; i < rdata.length; i++) {\n              rY.push(rdata[i][1]);\n              rX.push(rdata[i][0]);\n            }\n\n            this.setState({\n              intX: rX,\n              //support@refer.telus.com dexter hugo \n              intY: rY,\n              cmpload: true\n            });\n          });\n        }\n\n        this.setState({\n          ipopup: true,\n          iposition: e.latlng,\n          key: numMapClicks++,\n          ititle: feature.properties.DAUID\n        });\n      });\n    });\n\n    _defineProperty(this, \"onEachFeature\", (feature, layer) => {\n      var checkDauId = feature.properties.DAUID;\n      layer.on('click', e => {\n        this.setState({\n          gpopup: true,\n          position: e.latlng,\n          key: numMapClicks++\n        });\n\n        if (this.state.gendata.length === 0) {\n          this.setState({\n            gLoading: false\n          });\n        } else {\n          this.setState({\n            gLoading: true\n          });\n        }\n\n        if (this.state.gLoading) {\n          for (var i = 0; i < this.state.gendata.length; i++) {\n            if (this.state.gendata[i].DAUID === checkDauId) {\n              const title = 'Index:' + this.state.gendata[i].Index;\n              this.setState({\n                genX: this.state.gendata[i].X,\n                genY: this.state.gendata[i].Y,\n                gtitle: title\n              });\n              break;\n            }\n          }\n        }\n      });\n\n      if (this.state.gendata.length === 0) {\n        this.setState({\n          gLoading: false\n        });\n      } else {\n        this.setState({\n          gLoading: true\n        });\n      } // if(this.state.gLoading){\n      //     layer.setStyle({fillColor : this.getColor(this.state.genres[checkDauId]) ,color:this.getColor(this.state.genres[checkDauId]),opacity:1,fillOpacity:0.3,weight:1})\n      // }\n\n    });\n\n    this.state = {\n      weight: 0.5,\n      opacity: 1,\n      color: '#ffcc99',\n      color2: '#ff66b2',\n      gpopup: false,\n      ipopup: false,\n      position: [],\n      iposition: [],\n      gtitle: '',\n      ititle: '',\n      key: numMapClicks++,\n      gkey: geoMapClicks++,\n      ikey: geoMapClicks2,\n      gLoading: false,\n      iLoading: false,\n      genres: {},\n      intres: {},\n      gendata: [],\n      intdata: [],\n      genX: [],\n      genY: [],\n      intX: [],\n      intY: [],\n      ajaxload: false,\n      cmpload: false,\n      iweight: {}\n    };\n  }\n\n  componentDidUpdate(oldProps, oldState) {\n    if (this.props.genres !== oldState.genres && this.props.gendata !== oldState.gendata || this.props.intres !== oldState.intres && this.props.intdata !== oldState.intdata || this.props.ajaxload !== oldState.ajaxload || this.props.iweight !== oldState.iweight) {\n      this.setState({\n        genres: this.props.genres,\n        gendata: this.props.gendata,\n        gkey: geoMapClicks,\n        ikey: geoMapClicks2,\n        intres: this.props.intres,\n        intdata: this.props.intdata,\n        weight: 1,\n        ajaxload: this.props.ajaxload,\n        iweight: this.props.iweight\n      });\n    } // if(this.props.intres !== oldState.intres && this.props.intdata!==oldState.intdata){\n    //    console.log(this.props.intres);\n    //    this.setState({\n    //      intres:this.props.intres,\n    //      intdata:this.props.intdata\n    //    })\n    // }\n\n  }\n\n  render() {\n    var style = feature => {\n      var checkDauId = feature.properties.DAUID;\n\n      if (this.state.gendata.length > 0) {\n        return {\n          fillColor: this.getColor(this.state.genres[checkDauId]),\n          color: this.getColor(this.state.genres[checkDauId]),\n          opacity: 1,\n          fillOpacity: 0.3,\n          weight: this.state.iweight[checkDauId]\n        };\n      } //   else{\n      //   return ({\n      //       weight: this.state.weight,\n      //       opacity: this.state.opacity\n      //     }\n      //   );\n      // }\n\n    };\n\n    var style2 = feature => {\n      var checkDauId = feature.properties.DAUID;\n\n      if (this.state.intdata.length > 0) {\n        return {\n          fillColor: this.getColor(this.state.intres[checkDauId]),\n          color: this.getColor(this.state.intres[checkDauId]),\n          opacity: 1,\n          fillOpacity: 0.3,\n          weight: this.state.iweight[checkDauId]\n        };\n      }\n    }; // const onEachFeature2 = (feature,layer) => {\n    //     console.log(feature.properties[\"DAUID\"]);\n    //     layer.setStyle({fillColor : this.state.color2 ,color:this.state.color2,opacity:this.state.opacity,fillOpacity:0.4,weight:0.4})\n    //     layer.on('click',(e)=>{\n    //       this.setState({\n    //          ipopup:true,\n    //          iposition:e.latlng,\n    //          key:numMapClicks++,\n    //          ititle:feature.properties.DAUID\n    //       });\n    //   })\n    // }\n\n\n    return __jsx(Layout.Section, {\n      oneHalf: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    }, __jsx(Card, {\n      title: \"Visualization\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    }, this.state.ajaxload == false ? __jsx(Map, {\n      center: [44.755113, -63.320488],\n      zoom: 9,\n      style: {\n        height: \"60vh\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, __jsx(TileLayer, {\n      attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n      url: \"http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274\n      },\n      __self: this\n    }), __jsx(LayersControl, {\n      position: \"topright\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }, __jsx(LayersControl.BaseLayer, {\n      name: \"Index\",\n      checked: \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }, __jsx(GeoJSON // key={this.state.gkey}\n    , {\n      ref: \"geojson2\",\n      data: diss,\n      style: style,\n      onEachFeature: (feature, layer) => this.onEachFeature(feature, layer),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    }), this.state.gpopup && __jsx(Popup, {\n      key: this.state.key,\n      position: this.state.position,\n      onClose: () => {\n        this.setState({\n          popup: false\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      style: {\n        width: 320 + 'px',\n        height: 240 + 'px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291\n      },\n      __self: this\n    }, this.state.gLoading ? __jsx(Barplot, {\n      X: this.state.genX,\n      Y: this.state.Y,\n      title: this.state.title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292\n      },\n      __self: this\n    }) : __jsx(Spinner, {\n      accessibilityLabel: \"Spinner example\",\n      size: \"large\",\n      color: \"teal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292\n      },\n      __self: this\n    })))), __jsx(LayersControl.BaseLayer, {\n      name: \"Interpret\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    }, __jsx(GeoJSON, {\n      key: this.state.ikey,\n      ref: \"geojson\",\n      data: diss,\n      style: style2,\n      onEachFeature: (feature, layer) => this.onEachFeature2(feature, layer),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300\n      },\n      __self: this\n    }), this.state.ipopup && __jsx(Popup, {\n      key: this.state.key,\n      position: this.state.iposition,\n      onClose: () => {\n        this.setState({\n          ipopup: false\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      style: {\n        width: 320 + 'px',\n        height: 240 + 'px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308\n      },\n      __self: this\n    }, this.state.iLoading && this.state.cmpload ? __jsx(Barplot, {\n      X: this.state.intX,\n      Y: this.state.intY,\n      title: this.state.ititle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309\n      },\n      __self: this\n    }) : __jsx(Spinner, {\n      accessibilityLabel: \"Spinner example\",\n      size: \"large\",\n      color: \"teal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309\n      },\n      __self: this\n    })))))) : __jsx(Spinner, {\n      accessibilityLabel: \"Spinner example\",\n      size: \"large\",\n      color: \"teal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default Maps;","map":{"version":3,"sources":["/home/balaji/hello-next/components/Maps.js"],"names":["React","Map","TileLayer","Popup","LayersControl","GeoJSON","diss","Card","Layout","Spinner","axios","dynamic","Barplot","ssr","numMapClicks","geoMapClicks","geoMapClicks2","Maps","Component","constructor","props","val","feature","layer","state","intdata","length","setState","iLoading","on","e","data","properties","DAUID","cmpload","get","params","then","result","rX","rY","rdata","i","push","intX","intY","ipopup","iposition","latlng","key","ititle","checkDauId","gpopup","position","gendata","gLoading","title","Index","genX","X","genY","Y","gtitle","weight","opacity","color","color2","gkey","ikey","genres","intres","ajaxload","iweight","componentDidUpdate","oldProps","oldState","render","style","fillColor","getColor","fillOpacity","style2","height","onEachFeature","popup","width","onEachFeature2"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Map, TileLayer,Popup,LayersControl,GeoJSON } from \"react-leaflet-universal\";\nimport \"leaflet/dist/leaflet.css\";\nimport diss from '../data/Dissemination.json';\nimport '@shopify/polaris/styles.css';\nimport {Card,Layout,Spinner} from '@shopify/polaris';\nimport axios from 'axios';\nimport dynamic from 'next/dynamic'\nconst Barplot = dynamic(import('./BarPlot'),{\n  ssr:false\n})\n\n// L.Icon.Default.imagePath = '.';\n// // OR\n// delete L.Icon.Default.prototype._getIconUrl;\n\n// L.Icon.Default.mergeOptions({\n//   iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n//   iconUrl: require('leaflet/dist/images/marker-icon.png'),\n//   shadowUrl: require('leaflet/dist/images/marker-shadow.png'),\n// });\n\n\nlet numMapClicks = 0\nlet geoMapClicks=0\nlet geoMapClicks2=0\n\n  class Maps extends React.Component{\n\n    constructor(props) {\n        super(props);\n        this.state = {\n          weight: 0.5,\n          opacity: 1,\n          color: '#ffcc99',\n          color2: '#ff66b2',\n          gpopup: false,\n          ipopup:false,\n          position:[],\n          iposition:[],\n          gtitle:'',\n          ititle:'',\n          key:numMapClicks++,\n          gkey:geoMapClicks++,\n          ikey:geoMapClicks2,\n          gLoading:false,\n          iLoading:false,\n          genres:{},\n          intres:{},\n          gendata:[],\n          intdata:[],\n          genX:[],\n          genY:[],\n          intX:[],\n          intY:[],\n          ajaxload:false,\n          cmpload:false,\n          iweight:{}\n        };\n      }\n      componentDidUpdate(oldProps,oldState){\n    \n        \n        if((this.props.genres !== oldState.genres && this.props.gendata!==oldState.gendata) || (this.props.intres !== oldState.intres && this.props.intdata!==oldState.intdata)  || (this.props.ajaxload!== oldState.ajaxload) || (this.props.iweight!== oldState.iweight)){\n         \n        \n            this.setState({\n                genres:this.props.genres,\n                gendata:this.props.gendata,\n                gkey:geoMapClicks,\n                ikey:geoMapClicks2,\n                intres:this.props.intres,\n                intdata:this.props.intdata,\n                weight:1,\n                ajaxload:this.props.ajaxload,\n                iweight:this.props.iweight\n            });\n          \n        }\n        // if(this.props.intres !== oldState.intres && this.props.intdata!==oldState.intdata){\n        //    console.log(this.props.intres);\n        //    this.setState({\n        //      intres:this.props.intres,\n        //      intdata:this.props.intdata\n        //    })\n        // }\n    }\n\n     getColor = (val) => {\n\n\n      return val>=-1 && val < -0.75? '#a50026':\n             val>=-0.75 && val < -0.6 ? '#d73027':\n             val>=-0.6 && val < -0.4 ? '#f46d43':\n             val>=-0.4 && val < -0.2 ? '#fdae61':\n             val>=-0.2 && val < 0 ? '#fee08b':\n             val>=0.01   &&  val <0.1 ? '#d9ef8b':\n             val>=0.1 && val < 0.3 ? '#a6d96a':\n             val>=0.3 && val < 0.5 ? '#66bd63':\n             val>=0.5 && val < 0.75 ? '#1a9850':\n             val >= 0.75 && val <= 1 ? '#006837':\n             val>=0 && val <0.01 ? '#ffffff':\n                                   '#000000';\n\n    };\n\n    onEachFeature2 = (feature,layer) => {\n      //layer.setStyle({fillColor : this.state.color2 ,color:this.state.color2,opacity:this.state.opacity,fillOpacity:0.4,weight:0.4})\n      if(this.state.intdata.length===0){\n        this.setState({\n            iLoading:false\n        })\n        }\n        else{\n            this.setState({\n                iLoading:true\n            })\n        }\n      layer.on('click',(e)=>{\n       \n        if(this.state.iLoading){\n        var data={}\n        data['DAUID']=feature.properties.DAUID;\n        this.setState({\n           cmpload:true\n        })\n        axios.get('http://localhost:5000/rest/explainer/',{params:data})\n        .then(result => {\n\n          \n          var rX=[]\n          var rY=[]\n          var rdata=result.data['exp'];\n          for(var i=0;i<rdata.length;i++){\n              rY.push(rdata[i][1])\n              rX.push(rdata[i][0])\n          }\n     \n          this.setState(\n\n            {\n               intX:rX,\n               //support@refer.telus.com dexter hugo \n               intY:rY,\n               cmpload:true\n            }\n          )\n        });\n      }\n        this.setState({\n           ipopup:true,\n           iposition:e.latlng,\n           key:numMapClicks++,\n           ititle:feature.properties.DAUID\n        });\n    });\n  }\n   \n\n     onEachFeature = (feature,layer) => {\n\n\n      var checkDauId=feature.properties.DAUID;\n      layer.on('click',(e)=>{\n          \n          this.setState({\n             gpopup:true,\n             position:e.latlng,\n             key:numMapClicks++,\n             \n          });\n          if(this.state.gendata.length===0){\n              this.setState({\n                  gLoading:false\n              })\n          }\n          else{\n              this.setState({\n                  gLoading:true\n              })\n          }\n          if(this.state.gLoading){\n            for(var i=0;i<this.state.gendata.length;i++){\n\n                if(this.state.gendata[i].DAUID===checkDauId){\n                    const title='Index:'+this.state.gendata[i].Index;\n                    this.setState(\n\n                      {\n                         genX:this.state.gendata[i].X,\n                         genY:this.state.gendata[i].Y,\n                         gtitle:title\n                      }\n                    )\n                    \n                    break;\n                }\n            }\n          }\n      });\n    if(this.state.gendata.length===0){\n      this.setState({\n          gLoading:false\n      })\n  }\n  else{\n      this.setState({\n          gLoading:true\n      })\n  }\n  // if(this.state.gLoading){\n  //     layer.setStyle({fillColor : this.getColor(this.state.genres[checkDauId]) ,color:this.getColor(this.state.genres[checkDauId]),opacity:1,fillOpacity:0.3,weight:1})\n  // }\n  }\n    render(){\n\n        \n\n        var style = (feature) => {\n            var checkDauId=feature.properties.DAUID;\n            if(this.state.gendata.length>0){\n                return ({\n                    fillColor: this.getColor(this.state.genres[checkDauId]),\n                    color:this.getColor(this.state.genres[checkDauId]),\n                    opacity:1,\n                    fillOpacity:0.3,\n                    weight:this.state.iweight[checkDauId]\n                });\n            }\n          //   else{\n          //   return ({\n                \n          //       weight: this.state.weight,\n          //       opacity: this.state.opacity\n          //     }\n          //   );\n          // }\n    \n        }\n       \n      var style2 = (feature) => {\n        var checkDauId=feature.properties.DAUID;\n        if(this.state.intdata.length>0){\n            return ({\n                fillColor: this.getColor(this.state.intres[checkDauId]),\n                color:this.getColor(this.state.intres[checkDauId]),\n                opacity:1,\n                fillOpacity:0.3,\n                weight:this.state.iweight[checkDauId]\n            });\n        }\n  \n      }\n      // const onEachFeature2 = (feature,layer) => {\n\n      //     console.log(feature.properties[\"DAUID\"]);\n      //     layer.setStyle({fillColor : this.state.color2 ,color:this.state.color2,opacity:this.state.opacity,fillOpacity:0.4,weight:0.4})\n      //     layer.on('click',(e)=>{\n            \n      //       this.setState({\n      //          ipopup:true,\n      //          iposition:e.latlng,\n      //          key:numMapClicks++,\n      //          ititle:feature.properties.DAUID\n      //       });\n      //   })\n      // }\n        return (\n          \n          <Layout.Section oneHalf>\n          <Card title=\"Visualization\">\n          {(this.state.ajaxload==false)?(\n            <Map center={[44.755113, -63.320488]} zoom={9} style={{ height: \"60vh\" }} >\n                <TileLayer\n                attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n                url=\"http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png\"\n              />\n             \n              <LayersControl position=\"topright\">\n              \n              <LayersControl.BaseLayer name=\"Index\" checked=\"true\">\n              <GeoJSON \n                // key={this.state.gkey}\n                ref=\"geojson2\"\n                data={diss}\n                style={style}\n                onEachFeature={(feature,layer)=>this.onEachFeature(feature,layer)}\n              />\n            \n               {this.state.gpopup && <Popup key={this.state.key} position={this.state.position} onClose={()=>{this.setState({popup:false})}}>\n               <div style={{width:320+'px',height:240+'px'}}>\n               {(this.state.gLoading)?(<Barplot X={this.state.genX} Y={this.state.Y} title={this.state.title}/>):(<Spinner accessibilityLabel=\"Spinner example\" size=\"large\" color=\"teal\" />)}\n                  </div>\n                </Popup>\n                \n                }\n            \n              </LayersControl.BaseLayer>\n              <LayersControl.BaseLayer name=\"Interpret\">\n              <GeoJSON \n                key={this.state.ikey}\n                ref=\"geojson\"\n                data={diss}\n                style={style2}\n                onEachFeature={(feature,layer)=>this.onEachFeature2(feature,layer)}\n              />\n              {this.state.ipopup && <Popup key={this.state.key} position={this.state.iposition} onClose={()=>{this.setState({ipopup:false})}}>\n              <div style={{width:320+'px',height:240+'px'}}>\n              {(this.state.iLoading && this.state.cmpload)?(<Barplot X={this.state.intX} Y={this.state.intY} title={this.state.ititle}/>):(<Spinner accessibilityLabel=\"Spinner example\" size=\"large\" color=\"teal\" />)}\n                  </div>\n                </Popup>}\n            \n              </LayersControl.BaseLayer>\n              </LayersControl>\n              \n\n            </Map>):\n           <Spinner accessibilityLabel=\"Spinner example\" size=\"large\" color=\"teal\" />}\n\n      </Card>\n      {/* <Card title=\"demo\">\n        <div id=\"te\">\n\n                 {(this.state.gLoading)?(<BarChart data={this.state.gendata}/>):<p>Waiting for Contents</p>}\n        </div>\n      </Card> */}\n    </Layout.Section>\n  );\n    \n  };\n}\n\nexport default Maps;\n"]},"metadata":{},"sourceType":"module"}